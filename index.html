<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3dproject.ve | Suite Financiera</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Librerías para generación de PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --cream-bg: #FDFCF8;
            --velvet-green: #1B3022;
            --velvet-green-light: #2D4A36;
            --gold-accent: #C5A059;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--cream-bg);
            color: var(--velvet-green);
        }
        .bg-velvet { background-color: var(--velvet-green); }
        .text-velvet { color: var(--velvet-green); }
        .border-velvet { border-color: var(--velvet-green); }
        .btn-primary {
            background-color: var(--velvet-green);
            color: white;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background-color: var(--velvet-green-light);
            transform: translateY(-1px);
        }
        .card {
            background: white;
            border: 1px solid rgba(27, 48, 34, 0.1);
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }
        .nav-link {
            position: relative;
            padding-bottom: 4px;
            transition: all 0.2s;
        }
        .nav-link.active {
            color: var(--velvet-green);
            font-weight: 700;
            border-bottom: 2px solid var(--velvet-green);
        }
        input, select, textarea {
            border: 1px solid #E2E8F0;
            border-radius: 8px;
            padding: 8px 12px;
            outline: none;
        }
        input:focus {
            border-color: var(--velvet-green);
        }
        .brecha-badge {
            background-color: #FEF2F2;
            color: #991B1B;
            padding: 2px 8px;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }
    </style>
</head>
<body class="min-h-screen">
    <div id="app" class="max-w-6xl mx-auto px-4 py-8">
        <!-- Header -->
        <header class="flex flex-col md:flex-row justify-between items-center mb-10 gap-4">
            <div>
                <h1 class="text-3xl font-bold tracking-tight text-velvet uppercase italic">3dproject<span class="text-gold-accent">.ve</span></h1>
                <p class="text-sm opacity-70 italic text-velvet">Gestión Financiera de Alto Nivel para Manufactura Aditiva</p>
            </div>
            
            <div class="flex gap-4 items-center bg-white p-4 rounded-xl shadow-sm border border-gray-100">
                <div class="text-right">
                    <p class="text-xs font-semibold uppercase text-gray-500">Tasa BCV</p>
                    <input type="number" id="tasaBCV" value="48.50" step="0.01" class="w-24 text-right font-bold text-sm" onchange="updateExchangeData()">
                </div>
                <div class="h-8 w-px bg-gray-200"></div>
                <div class="text-right">
                    <p class="text-xs font-semibold uppercase text-gray-500">Tasa Paralela</p>
                    <input type="number" id="tasaParalela" value="56.20" step="0.01" class="w-24 text-right font-bold text-sm" onchange="updateExchangeData()">
                </div>
                <div class="h-8 w-px bg-gray-200"></div>
                <div class="text-center">
                    <p class="text-xs font-semibold uppercase text-gray-500">Brecha</p>
                    <span id="brechaPerc" class="brecha-badge">0.0%</span>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="flex gap-8 border-b border-gray-200 mb-8 overflow-x-auto pb-1">
            <button onclick="switchTab('dashboard', event)" class="nav-link active font-medium whitespace-nowrap" id="tab-dashboard">Dashboard General</button>
            <button onclick="switchTab('cotizador', event)" class="nav-link font-medium whitespace-nowrap" id="tab-cotizador">Generador de Cotizaciones</button>
            <button onclick="switchTab('finanzas', event)" class="nav-link font-medium whitespace-nowrap" id="tab-finanzas">Estado de Resultados</button>
        </nav>

        <!-- Main Content Area -->
        <main>
            <!-- DASHBOARD SECTION -->
            <section id="section-dashboard" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="card p-6 border-l-4 border-l-velvet">
                        <p class="text-sm text-gray-500 font-medium mb-1">Flujo Neto del Mes</p>
                        <h2 class="text-3xl font-bold text-velvet" id="dash-flujoNeto">$0.00</h2>
                        <p class="text-xs text-gray-400 mt-2">Esperando registros...</p>
                    </div>
                    <div class="card p-6 border-l-4 border-l-gold-accent">
                        <p class="text-sm text-gray-500 font-medium mb-1">Margen de Utilidad Promedio</p>
                        <h2 class="text-3xl font-bold text-velvet" id="dash-margen">0%</h2>
                        <p class="text-xs text-gray-400 mt-2">Basado en operaciones reales</p>
                    </div>
                    <div class="card p-6 border-l-4 border-l-red-600">
                        <p class="text-sm text-gray-500 font-medium mb-1">Impacto Brecha Cambiaria</p>
                        <h2 class="text-3xl font-bold text-red-600" id="dash-brecha">$0.00</h2>
                        <p class="text-xs text-gray-400 mt-2">Capital en riesgo por diferencial</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="card p-6">
                        <h3 class="font-bold mb-4 text-velvet uppercase text-xs">Relación de Balance</h3>
                        <div class="h-48 flex items-end gap-4 justify-around pt-4 border-b border-gray-100">
                            <div class="w-12 bg-velvet rounded-t-lg transition-all duration-500" id="chart-ingresos" style="height: 5%"></div>
                            <div class="w-12 bg-red-800 rounded-t-lg transition-all duration-500" id="chart-egresos" style="height: 5%"></div>
                        </div>
                    </div>
                    <div class="card p-6 flex flex-col justify-center items-center text-center">
                        <h3 class="text-2xl font-bold mb-2 italic">Piezas de Alta Precisión</h3>
                        <p class="text-sm opacity-80 mb-4">Optimiza la producción con el ajuste de brecha automática y cálculo por minutos.</p>
                        <button onclick="switchTab('cotizador')" class="bg-gold-accent text-velvet font-bold py-2 px-4 rounded-lg hover:scale-105 transition-transform">Nueva Cotización</button>
                    </div>
                </div>
            </section>

            <!-- COTIZADOR SECTION -->
            <section id="section-cotizador" class="hidden space-y-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Formulario -->
                    <div class="card p-6 space-y-4">
                        <h3 class="text-xl font-bold border-b pb-2 mb-4">Configuración de Cotización</h3>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div class="flex flex-col">
                                <label class="text-xs font-bold uppercase mb-1">Nombre del Cliente</label>
                                <input type="text" id="q-cliente" placeholder="Ej: Juan Pérez" class="w-full">
                            </div>
                            <div class="flex flex-col">
                                <label class="text-xs font-bold uppercase mb-1">Nombre de la Pieza</label>
                                <input type="text" id="q-pieza" placeholder="Ej: Engranaje Industrial" value="Pieza Personalizada" class="w-full">
                            </div>
                        </div>

                        <!-- Tiempo de Impresión Mejorado -->
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                            <div class="flex flex-col md:col-span-1">
                                <label class="text-xs font-bold uppercase mb-1">Horas</label>
                                <input type="number" id="q-horas" value="1" min="0" oninput="calculateQuote()" class="w-full">
                            </div>
                            <div class="flex flex-col md:col-span-1">
                                <label class="text-xs font-bold uppercase mb-1 text-gold-accent">Minutos</label>
                                <input type="number" id="q-minutos" value="30" min="0" max="59" oninput="calculateQuote()" class="w-full border-gold-accent">
                            </div>
                            <div class="flex flex-col md:col-span-1">
                                <label class="text-xs font-bold uppercase mb-1">Gramos</label>
                                <input type="number" id="q-gramos" value="25" min="1" oninput="calculateQuote()" class="w-full">
                            </div>
                            <div class="flex flex-col md:col-span-1">
                                <label class="text-xs font-bold uppercase mb-1">Material</label>
                                <select id="q-material" class="w-full">
                                    <option value="PLA">PLA</option>
                                    <option value="PETG">PETG</option>
                                    <option value="ABS">ABS</option>
                                    <option value="TPU">TPU</option>
                                </select>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 border-t pt-4">
                            <div class="flex flex-col">
                                <label class="text-xs font-bold uppercase mb-1">Costo Material ($/kg)</label>
                                <input type="number" id="q-costoMaterial" value="25.00" oninput="calculateQuote()" class="w-full">
                            </div>
                            <div class="flex flex-col">
                                <label class="text-xs font-bold uppercase mb-1 text-gold-accent">Costo de Empaque ($)</label>
                                <input type="number" id="q-empaque" value="0.50" oninput="calculateQuote()" class="w-full border-gold-accent">
                            </div>
                        </div>

                        <div class="flex flex-col bg-gray-50 p-4 rounded-lg">
                            <label class="text-xs font-bold uppercase mb-1">Porcentaje de Utilidad Deseada (%)</label>
                            <input type="range" id="q-ganancia" min="10" max="300" value="100" class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-velvet" oninput="calculateQuote()">
                            <div class="flex justify-between mt-2">
                                <span class="text-sm font-bold text-velvet"><span id="ganancia-val">100</span>%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Resumen -->
                    <div class="space-y-6">
                        <div class="card p-6 border-l-4 border-l-velvet">
                            <h3 class="text-lg font-bold mb-4">Análisis de Rentabilidad</h3>
                            
                            <div class="space-y-3 mb-6 text-sm">
                                <div class="flex justify-between">
                                    <span class="text-gray-500">Costo Producción</span>
                                    <span class="font-semibold" id="res-costoBase">$0.00</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-500">Costo de Empaque</span>
                                    <span class="font-semibold" id="res-empaqueUSD">$0.00</span>
                                </div>
                                <div class="flex justify-between font-bold border-t pt-2">
                                    <span>Valor Real (USD)</span>
                                    <span id="res-totalUSD">$0.00</span>
                                </div>
                            </div>

                            <div class="bg-velvet p-6 rounded-xl text-white text-center">
                                <p class="text-xs uppercase tracking-widest mb-1 opacity-70">Precio Final a Cobrar (VES)</p>
                                <h2 class="text-4xl font-bold mb-2" id="res-finalVES">0,00</h2>
                                <p class="text-sm opacity-90">Equivalente a <span id="res-finalBCVUSD">$0.00</span> a tasa BCV</p>
                            </div>

                            <button onclick="generatePDF()" class="w-full btn-primary py-4 rounded-xl font-bold mt-6 flex items-center justify-center space-x-3 shadow-lg transition-all hover:scale-[1.02]">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd" />
                                </svg>
                                <span>DESCARGAR COTIZACIÓN EN PDF</span>
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- FINANZAS SECTION -->
            <section id="section-finanzas" class="hidden space-y-6">
                <div class="card p-6">
                    <h3 class="text-xl font-bold mb-6">Estado de Resultados (P&L)</h3>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left">
                            <thead class="bg-gray-50 text-xs uppercase text-gray-500">
                                <tr>
                                    <th class="px-4 py-3">Concepto</th>
                                    <th class="px-4 py-3 text-right">USD Real</th>
                                    <th class="px-4 py-3 text-right">VES (BCV)</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-100" id="fin-table-body">
                                <tr>
                                    <td class="px-4 py-4 font-bold">Ingresos Operacionales</td>
                                    <td class="px-4 py-4 text-right font-bold text-green-600" id="val-ingresos-usd">$0.00</td>
                                    <td class="px-4 py-4 text-right text-gray-600" id="val-ingresos-ves">0,00</td>
                                </tr>
                                <tr class="bg-velvet text-white font-bold">
                                    <td class="px-4 py-4 rounded-l-lg">Utilidad Neta Final</td>
                                    <td class="px-4 py-4 text-right" id="val-neta-usd">$0.00</td>
                                    <td class="px-4 py-4 text-right rounded-r-lg" id="val-neta-ves">0,00</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- Registro Manual -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="card p-6">
                        <h4 class="font-bold mb-4">Registro Manual</h4>
                        <div class="space-y-3">
                            <select id="reg-tipo" class="w-full font-bold">
                                <option value="ingreso">Venta (+)</option>
                                <option value="costo">Gasto (-)</option>
                            </select>
                            <div class="grid grid-cols-2 gap-2">
                                <input type="number" id="reg-monto" placeholder="Monto" class="w-full font-bold">
                                <select id="reg-moneda" class="w-full font-bold">
                                    <option value="USD">USD</option>
                                    <option value="VES">Bs. BCV</option>
                                </select>
                            </div>
                            <button onclick="registrarMovimiento()" class="w-full btn-primary py-3 rounded-lg font-bold uppercase">Actualizar Balance</button>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="mt-16 pt-8 border-t border-gray-200 text-center text-gray-400 text-xs uppercase tracking-widest">
            3dproject.ve | Suite Financiera de Precisión | 2026
        </footer>
    </div>

    <script>
        // PEGA AQUÍ TU LOGO EN FORMATO BASE64 ENTRE LAS COMILLAS
        const logoBase64 = ""; 

        let totalIngresosUSD = 0;
        let totalCostosUSD = 0;

        function switchTab(tabId, event) {
            document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden'));
            document.querySelectorAll('nav > button').forEach(b => b.classList.remove('active'));
            document.getElementById('section-' + tabId).classList.remove('hidden');
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                const btn = document.getElementById('tab-' + tabId);
                if (btn) btn.classList.add('active');
            }
        }

        function updateExchangeData() {
            const bcv = parseFloat(document.getElementById('tasaBCV').value) || 1;
            const para = parseFloat(document.getElementById('tasaParalela').value) || 1;
            const brecha = ((para / bcv) - 1) * 100;
            document.getElementById('brechaPerc').innerText = brecha.toFixed(1) + '%';
            renderFinances();
            calculateQuote();
        }

        function registrarMovimiento() {
            const tipo = document.getElementById('reg-tipo').value;
            const montoRaw = parseFloat(document.getElementById('reg-monto').value);
            const moneda = document.getElementById('reg-moneda').value;
            const bcv = parseFloat(document.getElementById('tasaBCV').value) || 1;
            if (isNaN(montoRaw) || montoRaw <= 0) return;
            const montoUSD = moneda === 'VES' ? montoRaw / bcv : montoRaw;
            if (tipo === 'ingreso') totalIngresosUSD += montoUSD;
            else totalCostosUSD += montoUSD;
            document.getElementById('reg-monto').value = '';
            renderFinances();
        }

        function renderFinances() {
            const bcv = parseFloat(document.getElementById('tasaBCV').value) || 1;
            const para = parseFloat(document.getElementById('tasaParalela').value) || 1;
            const netaUSD = totalIngresosUSD - totalCostosUSD;
            const margen = totalIngresosUSD > 0 ? (netaUSD / totalIngresosUSD) * 100 : 0;
            const perdidaBrecha = totalIngresosUSD * ((para / bcv) - 1);

            document.getElementById('dash-flujoNeto').innerText = `$${netaUSD.toLocaleString('en-US', {minimumFractionDigits: 2})}`;
            document.getElementById('dash-margen').innerText = `${margen.toFixed(1)}%`;
            document.getElementById('dash-brecha').innerText = `$${perdidaBrecha.toLocaleString('en-US', {minimumFractionDigits: 2})}`;

            document.getElementById('chart-ingresos').style.height = `${totalIngresosUSD > 0 ? 100 : 5}%`;
            document.getElementById('chart-egresos').style.height = `${totalCostosUSD > 0 ? 100 : 5}%`;

            const formatVES = (usd) => (usd * bcv).toLocaleString('de-DE', {minimumFractionDigits: 2});
            document.getElementById('val-ingresos-usd').innerText = `$${totalIngresosUSD.toFixed(2)}`;
            document.getElementById('val-ingresos-ves').innerText = formatVES(totalIngresosUSD);
            document.getElementById('val-neta-usd').innerText = `$${netaUSD.toFixed(2)}`;
            document.getElementById('val-neta-ves').innerText = formatVES(netaUSD);
        }

        function calculateQuote() {
            const bcv = parseFloat(document.getElementById('tasaBCV').value) || 1;
            const para = parseFloat(document.getElementById('tasaParalela').value) || 1;
            const h = parseFloat(document.getElementById('q-horas').value) || 0;
            const min = parseFloat(document.getElementById('q-minutos').value) || 0;
            const g = parseFloat(document.getElementById('q-gramos').value) || 0;
            const costMatKg = parseFloat(document.getElementById('q-costoMaterial').value) || 0;
            const pkg = parseFloat(document.getElementById('q-empaque').value) || 0;
            const gananciaP = parseFloat(document.getElementById('q-ganancia').value) || 0;
            
            document.getElementById('ganancia-val').innerText = gananciaP;

            // Tiempo total en horas decimales
            const totalHours = h + (min / 60);

            // Lógica: Amortización 0.65 USD/hora
            const costBase = ((g / 1000) * costMatKg) + (totalHours * 0.65);
            const totalUSDRepo = (costBase + pkg) * (1 + (gananciaP / 100));

            const finalVES = totalUSDRepo * para;
            const invoiceUSD = finalVES / bcv;

            document.getElementById('res-costoBase').innerText = `$${costBase.toFixed(2)}`;
            document.getElementById('res-empaqueUSD').innerText = `$${pkg.toFixed(2)}`;
            document.getElementById('res-totalUSD').innerText = `$${totalUSDRepo.toFixed(2)}`;
            document.getElementById('res-finalVES').innerText = finalVES.toLocaleString('de-DE', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
            document.getElementById('res-finalBCVUSD').innerText = `$${invoiceUSD.toFixed(2)}`;
        }

        function generatePDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const cliente = document.getElementById('q-cliente').value || "Cliente Particular";
            const pieza = document.getElementById('q-pieza').value || "Pieza de Manufactura";
            const material = document.getElementById('q-material').value;
            const gramos = document.getElementById('q-gramos').value;
            const horas = document.getElementById('q-horas').value;
            const minutos = document.getElementById('q-minutos').value;
            const bcvUsd = document.getElementById('res-finalBCVUSD').innerText;
            const bcvVes = document.getElementById('res-finalVES').innerText;
            const fechaActual = new Date().toLocaleDateString('es-VE');

            // --- HOJA 1: COTIZACIÓN ---
            let cleanLogo = "";
            if (typeof logoBase64 !== 'undefined') {
                cleanLogo = logoBase64.trim();
                if (cleanLogo.startsWith('url(')) {
                    cleanLogo = cleanLogo.replace(/^url\(["']?/, '').replace(/["']?\)$/, '');
                }
            }

            let startY = 30;

            if (cleanLogo !== "") {
                try {
                    const logoSize = 65; 
                    const logoX = (210 - logoSize) / 2;
                    doc.addImage(cleanLogo, 'PNG', logoX, 15, logoSize, logoSize); 
                    startY = 90; 
                } catch (e) {
                    console.error("Logo error");
                    startY = 40;
                }
            }

            doc.setFont("times", "bold");
            doc.setFontSize(12);
            doc.setTextColor(27, 48, 34); 
            doc.text("COTIZACIÓN DE SERVICIOS", 20, startY);

            doc.setFont("times", "normal");
            doc.setFontSize(11);
            doc.setTextColor(50, 50, 50);
            doc.text(`Cliente: ${cliente}`, 20, startY + 10);
            doc.text(`Fecha: ${fechaActual}`, 20, startY + 18);
            doc.text(`Proyecto: ${pieza}`, 20, startY + 26);

            const tableRows = [
                ["Especificación", "Detalle"],
                ["Material", material],
                ["Gramos de filamento", `${gramos}g`],
                ["Tiempo de impresión", `${horas}h ${minutos}min`],
                ["Inversión Total USD (Ref. BCV)", bcvUsd],
                ["Monto Total Bs. (Ref. BCV)", `Bs. ${bcvVes}`]
            ];

            doc.autoTable({
                startY: startY + 40,
                head: [tableRows[0]],
                body: tableRows.slice(1),
                theme: 'grid',
                headStyles: {
                    fillColor: [27, 48, 34], 
                    textColor: [255, 255, 255],
                    fontStyle: 'bold',
                    fontSize: 10,
                    halign: 'center',
                    font: "times"
                },
                styles: {
                    font: "times",
                    fontSize: 10,
                    cellPadding: 6,
                    lineColor: [27, 48, 34],
                    lineWidth: 0.3,
                    halign: 'center'
                },
                columnStyles: {
                    0: { cellWidth: 90, fontStyle: 'bold' }, 
                    1: { cellWidth: 'auto' }
                }
            });

            doc.setFont("times", "bold");
            doc.setFontSize(10);
            doc.setTextColor(27, 48, 34);
            doc.text("Nota: Nuestros precios son a tasa BCV y en la siguiente hoja estarán los términos y condiciones.", 20, doc.lastAutoTable.finalY + 15);

            // --- HOJA 2: TÉRMINOS Y CONDICIONES ---
            doc.addPage();
            doc.setFont("times", "bold");
            doc.setFontSize(14);
            doc.setTextColor(27, 48, 34);
            doc.text("TÉRMINOS Y CONDICIONES DE VENTA", 105, 25, { align: "center" });

            const clausulas = [
                { t: "1. POLÍTICA DE PAGO (70/30):", c: "Para iniciar la producción, se requiere el pago del 70% del total presupuestado. El 30% restante deberá cancelarse obligatoriamente al momento de la entrega o envío de las piezas." },
                { t: "2. AJUSTE POR DIFERENCIAL CAMBIARIO:", c: "Los montos en Bs. se anclan a la tasa oficial BCV. En caso de retraso superior a 24h en el pago del saldo pendiente, 3dproject.ve se reserva el derecho de recalcular el monto según la tasa vigente del día." },
                { t: "3. RESPONSABILIDAD TÉCNICA Y DISEÑO:", c: "No nos hacemos responsables por fallas en archivos suministrados por el cliente. Las optimizaciones técnicas requeridas para impresión podrían generar cargos adicionales." },
                { t: "4. POLÍTICA DE CANCELACIONES:", c: "Una vez iniciada la manufactura, no existen reembolsos de anticipos debido al compromiso de materiales, energía y horas de máquina." },
                { t: "5. PLAZOS Y ENTREGAS:", c: "Los tiempos son estimados. No nos responsabilizamos por retrasos derivados de fallas eléctricas nacionales o escasez de materia prima importada." }
            ];

            let curY = 45;
            clausulas.forEach(item => {
                doc.setFont("times", "bold");
                doc.setFontSize(11);
                doc.text(item.t, 20, curY);
                curY += 7;
                doc.setFont("times", "normal");
                doc.setFontSize(10);
                const lines = doc.splitTextToSize(item.c, 170);
                doc.text(lines, 20, curY);
                curY += (lines.length * 5) + 10;
            });

            const fileName = `Cotizacion_3dproject_${cliente.replace(/\s+/g, '_')}.pdf`;
            doc.save(fileName);
        }

        window.onload = () => updateExchangeData();
    </script>
</body>
</html>
